<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
	  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	  autoReload="true">

	<extensions>
		<add assembly="NLog.Web.AspNetCore" />
	</extensions>

	<variable name="logPath" value="\\pcm.endress.com\projekt\Wartungskonzept_2_0\Logs\WebAPI\${aspnet-environment}" />

	<targets async="true">

		<target xsi:type="File"
				name="All"
				fileName="${logPath}\All\nlog-AspNetCore-All-Current.log"
				keepFileOpen="false"
				encoding="utf-8"
				archiveFileName="${logPath}\All\Archive\nlog-AspNetCore-All.{#}.log"
				archiveNumbering="Date"
				archiveEvery="Day"
				archiveDateFormat="yyyy-MM-dd"
				maxArchiveFiles="365"
				layout="${longdate}|${event-properties:item=EventId_Id:whenEmpty=0}|${uppercase:${level}}|${logger}|${message} ${exception:format=tostring}" />

		<target xsi:type="File"
				name="AllProblems"
				fileName="${logPath}\AllProblems\nlog-AspNetCore-AllProblems-Current.log"
				keepFileOpen="false"
				encoding="utf-8"
				archiveFileName="${logPath}\AllProblems\Archive\nlog-AspNetCore-AllProblems.{#}.log"
				archiveNumbering="Date"
				archiveEvery="Day"
				archiveDateFormat="yyyy-MM-dd"
				maxArchiveFiles="365"
				layout="${longdate}|${event-properties:item=EventId_Id:whenEmpty=0}|${uppercase:${level}}|${logger}|${message} ${exception:format=tostring}" />

		<target xsi:type="File"
				name="Passive"
				fileName="${logPath}\WebAPI\nlog-AspNetCore-WebAPI-Current.log"
				keepFileOpen="false"
				encoding="utf-8"
				archiveFileName="${logPath}\WebAPI\Archive\nlog-AspNetCore-WebAPI.{#}.log"
				archiveNumbering="Date"
				archiveEvery="Day"
				archiveDateFormat="yyyy-MM-dd"
				maxArchiveFiles="365"
				layout="${longdate}|${event-properties:item=EventId_Id:whenEmpty=0}|${uppercase:${level}}|${logger}|${message} ${exception:format=tostring}|url: ${aspnet-request-url}|action: ${aspnet-mvc-action}|${callsite}| body: ${aspnet-request-posted-body}" />

		<target xsi:type="File"
				name="LifeTime"
				fileName="${logPath}\LifeTime\nlog-AspNetCore-LifeTime-Current.log"
				archiveFileName="${logPath}\LifeTime\Archive\nlog-AspNetCore-LifeTime.{#}.log"
				keepFileOpen="false"
				encoding="utf-8"
				archiveNumbering="Date"
				archiveEvery="Day"
				archiveDateFormat="yyyy-MM-dd"
				maxArchiveFiles="365"
				layout="${longdate}|${event-properties:item=EventId_Id:whenEmpty=0}|${uppercase:${level}}|${logger}|${message} ${exception:format=tostring}" />
	</targets>

	<rules>
		<logger name="*" minlevel="Trace" writeTo="All" />

		<logger name = "*" minlevel="Warn" writeTo="AllProblems" />

		<logger name="Microsoft.Hosting.Lifetime" minlevel="Info" writeTo="LifeTime" final="true" />

		<logger name="Microsoft.*" maxlevel="Info" final="true" />

		<logger name="System.Net.Http.*" minlevel="Trace" final="true" />

		<logger name="Passive.*" minlevel="Trace" writeTo="Passive" />
	</rules>
</nlog>